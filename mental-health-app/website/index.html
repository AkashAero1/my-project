<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudentWell - Mental Health Support for Students</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
</head>
<body>
    <header>
        <a class="profile-top-btn" href="profile.html">
            <img class="profile-top-avatar" src="https://randomuser.me/api/portraits/men/32.jpg" alt="User Avatar">
            <span class="profile-top-name">Profile</span>
        </a>
        <div class="logo" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
            <img src="assets/images/Screenshot 2025-05-16 120317.png" alt="StudentWell Logo">
        </div>
        <p class="tagline">Supporting Student Mental Health Together</p>
        <nav>
            <ul>
                <li><a href="#about"><i class="fas fa-info-circle"></i> About Us</a></li>
                <li><a href="#features"><i class="fas fa-star"></i> Features</a></li>
                <li><a href="group-chat.html"><i class="fas fa-comments"></i> Group Chat</a></li>
                <li><a href="#Your-Mental-Health-Matters"><i class="fas fa-users"></i> Your Mental Health Matters</a></li>
                <li><a href="#contact"><i class="fas fa-envelope"></i> Contact</a></li>
            </ul>
        </nav>
    </header>
    <section class="mood-section" data-aos="fade-down">
        <div class="mood-greeting">
            <h2 id="greeting">Hi there, Student</h2>
            <p>How are you feeling today?</p>
        </div>
        <div class="mood-selector">
            <button class="mood-btn" title="Great" data-mood="Great" data-emoji="üòä" aria-label="Log mood: Great"><span class="mood-emoji">üòä</span><span>Great</span></button>
            <button class="mood-btn" title="Good" data-mood="Good" data-emoji="üôÇ" aria-label="Log mood: Good"><span class="mood-emoji">üôÇ</span><span>Good</span></button>
            <button class="mood-btn" title="Okay" data-mood="Okay" data-emoji="üòê" aria-label="Log mood: Okay"><span class="mood-emoji">üòê</span><span>Okay</span></button>
            <button class="mood-btn" title="Stressed" data-mood="Stressed" data-emoji="üòü" aria-label="Log mood: Stressed"><span class="mood-emoji">üòü</span><span>Stressed</span></button>
            <button class="mood-btn" title="Anxious" data-mood="Anxious" data-emoji="üò∞" aria-label="Log mood: Anxious"><span class="mood-emoji">üò∞</span><span>Anxious</span></button>
        </div>
        <button class="panic-btn" aria-label="Open calming modal"><i class="fas fa-exclamation-circle"></i> PANIC BUTTON</button>
        <button class="mood-history-btn">Mood History</button>
        <div id="mood-confirmation" class="mood-confirmation" style="display:none;">Mood saved!</div>
        <div id="mood-history-modal" class="mood-history-modal" style="display:none;">
            <div class="mood-history-content">
                <span class="mood-history-close">&times;</span>
                <h3>Your Mood History</h3>
                <div id="mood-history-list"></div>
            </div>
        </div>
    </section>
    <section class="breath-section" data-aos="fade-up">
        <h2>Breath With Me</h2>
        <div class="breath-container">
            <div class="breath-rings">
                <div class="breath-ring ring1"></div>
                <div class="breath-ring ring2"></div>
                <div class="breath-ring ring3"></div>
            <div class="breath-circle"></div>
            </div>
            <p class="breath-text">Breathe In</p>
        </div>
    </section>
    <main>
        <section id="features" data-aos="fade-up">
            <h2>Features</h2>
            <div class="features-grid">
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="50">
                    <i class="fas fa-brain"></i>
                    <h3>Mental Health Resources</h3>
                    <p>Access curated content, articles, and tools for managing stress and anxiety.</p>
                    <a href="mental-health-resources.html" class="feature-link">Explore <i class="fas fa-arrow-right"></i></a>                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="100">
                    <i class="fas fa-comments"></i>
                    <h3>Group Chat</h3>
                    <p>Connect with peers in a safe, moderated space to share experiences and support.</p>
                    <a href="#learn-more" class="feature-link">Chat Now<i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="150" id="moodtrack-card" style="cursor:pointer;">
                    <i class="fas fa-chart-line"></i>
                    <h3>Mood Tracking</h3>
                    <p>Monitor your emotional well-being with our intuitive mood tracking tools.</p>
                    <a class="feature-link" style="pointer-events:none;">Track Mood <i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="200">
                    <i class="fas fa-calendar-check"></i>
                    <h3>Study Planner</h3>
                    <p>Balance your academic and personal life with our smart study planning tools.</p>
                    <a href="study-planner.html" class="feature-link">Explore <i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="250">
                    <i class="fas fa-wind"></i>
                    <h3>Breathe</h3>
                    <p>Practice guided breathing exercises to relax and refocus.</p>
                    <a href="breathe.html" class="feature-link">Try Now <i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="300">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <h3>Learn</h3>
                    <p>Discover mental health tips and educational resources.</p>
                    <a href="learn.html" class="feature-link">Explore <i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="350" id="affirm-card" style="cursor:pointer;">
                    <i class="fas fa-sun"></i>
                    <h3>Affirm</h3>
                    <p>Boost your mood with daily positive affirmations.</p>
                    <a class="feature-link" style="pointer-events:none;">Get Affirmations <i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="400" id="journal-card" style="cursor:pointer;">
                    <i class="fas fa-book"></i>
                    <h3>Journal</h3>
                    <p>Reflect and grow by keeping a private journal.</p>
                    <a class="feature-link" style="pointer-events:none;">Start Journaling <i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="feature-card" data-aos="zoom-in" data-aos-delay="450" id="academic-card" style="cursor:pointer;">
                    <i class="fas fa-graduation-cap"></i>
                    <h3>Academic Support</h3>
                    <p>Tools to help you succeed academically.</p>
                    <a class="feature-link" style="pointer-events:none;">Access Tools <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
        </section>
        
        <section id="about" data-aos="fade-up">
            <h2>About Us</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>At StudentWell, we understand the unique challenges students face in their academic journey. Our mission is to provide a safe, supportive space where students can find resources, connect with peers, and prioritize their mental well-being.</p>
                    <div class="stats">
                       
                        <div class="stat-item" data-aos="zoom-in" data-aos-delay="150">
                            
                        </div>
                        <div class="stat-item" data-aos="zoom-in" data-aos-delay="200">
                            <i class="fas fa-heart"></i>
                            
                        </div>
                    </div>
                </div>
                <div class="about-image" data-aos="fade-left">
                    <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Students collaborating">
                </div>
            </div>
        </section>
        <section class="hero">
            <div class="hero-content" data-aos="fade-up">
                <h2>Your Mental Health Matters</h2>
                <p>Join a supportive community of students who understand the challenges of academic life.</p>
                <div class="cta-buttons">
                    <a href="#signup" class="btn primary">Get Started</a>
                    <a href="#learn-more" class="btn secondary">Learn More</a>
                </div>
            </div>
            <div class="hero-image" data-aos="fade-left">
                <img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Students studying">
            </div>
        </section>



        <section id="contact" data-aos="fade-up">
            <h2>Contact Us</h2>
            <div class="contact-container">
                <div class="contact-info" data-aos="fade-right">
                    <h3>Get in Touch</h3>
                    <p>Have questions or suggestions? We'd love to hear from you!</p>
                    <div class="contact-details">
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <p>support@studentwell.com</p>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <p>+1 (555) 123-4567</p>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <p>123 Education Street, Learning City</p>
                        </div>
                    </div>
                </div>
                <form class="contact-form" data-aos="fade-left">
                    <input type="text" placeholder="Your Name" required>
                    <input type="email" placeholder="Your Email" required>
                    <textarea placeholder="Your Message" required></textarea>
                    <button type="submit" class="btn primary">Send Message</button>
                </form>
            </div>
        </section>
    </main>
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#about">About Us</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#community">Community</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Connect With Us</h3>
                <div class="social-links">
                    <a href="https://x.com/" target="_blank"><i class="fab fa-twitter"></i></a>
                    <a href="https://www.instagram.com/" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.linkedin.com/" target="_blank"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Newsletter</h3>
                <form class="newsletter-form">
                    <input type="email" placeholder="Enter your email">
                    <button type="submit" class="btn secondary">Subscribe</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 StudentWell. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
        AOS.init({
            duration: 1000,
            once: true
        });
    </script>
    <script>
        // Enhanced Breath With Me Animation with animated rings
        (function() {
        const breathText = document.querySelector('.breath-text');
            const breathCircle = document.querySelector('.breath-circle');
            const ring1 = document.querySelector('.ring1');
            const ring2 = document.querySelector('.ring2');
            const ring3 = document.querySelector('.ring3');
        const breathPhases = [
                { text: 'Breathe In', duration: 4000, scale: 1.2 },
                { text: 'Hold', duration: 2000, scale: 1 },
                { text: 'Breathe Out', duration: 4000, scale: 0.8 },
                { text: 'Hold', duration: 2000, scale: 1 }
        ];
        let phase = 0;
        function animateBreath() {
            breathText.textContent = breathPhases[phase].text;
                const scale = breathPhases[phase].scale;
                breathCircle.style.transform = `scale(${scale})`;
                ring1.style.transform = `translate(-50%, -50%) scale(${scale + 0.1})`;
                ring2.style.transform = `translate(-50%, -50%) scale(${scale + 0.2})`;
                ring3.style.transform = `translate(-50%, -50%) scale(${scale + 0.3})`;
            setTimeout(() => {
                phase = (phase + 1) % breathPhases.length;
                animateBreath();
            }, breathPhases[phase].duration);
        }
            if (breathText && breathCircle && ring1 && ring2 && ring3) animateBreath();
        })();
    </script>
    <!-- Affirmation Modal -->
    <div id="affirm-modal" class="affirm-modal" style="display:none;">
        <div class="affirm-modal-content">
            <span class="affirm-close" id="affirm-close">&times;</span>
            <div class="affirm-illustration">
                <i class="fas fa-heart" style="font-size:3rem;color:#59c6cb;"></i>
            </div>
            <div class="affirm-text" id="affirm-text">You are enough just as you are.</div>
            <button class="btn primary" id="affirm-new">New Affirmation</button>
            <button class="btn secondary" id="affirm-share" style="margin-top:0.7rem;">Share</button>
            <div id="affirm-share-msg" style="color:#59c6cb;font-size:1rem;margin-top:0.5rem;display:none;">Copied!</div>
        </div>
    </div>
    <script>
        const affirmations = [
            "You are enough just as you are.",
            "You are capable of amazing things.",
            "Every day is a fresh start.",
            "You are stronger than you think.",
            "You deserve happiness and peace.",
            "You are making a difference.",
            "You are worthy of love and respect.",
            "Your feelings are valid.",
            "You can handle whatever comes your way.",
            "You are growing every day."
        ];
        const affirmCard = document.getElementById('affirm-card');
        const affirmModal = document.getElementById('affirm-modal');
        const affirmClose = document.getElementById('affirm-close');
        const affirmText = document.getElementById('affirm-text');
        const affirmNew = document.getElementById('affirm-new');
        const affirmShare = document.getElementById('affirm-share');
        const affirmShareMsg = document.getElementById('affirm-share-msg');
        affirmCard.onclick = () => {
            affirmModal.style.display = 'flex';
            showRandomAffirmation();
        };
        affirmClose.onclick = () => {
            affirmModal.style.display = 'none';
        };
        affirmNew.onclick = showRandomAffirmation;
        affirmShare.onclick = () => {
            const text = affirmText.textContent;
            if (navigator.share) {
                navigator.share({ text }).catch(() => {});
            } else if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    affirmShareMsg.style.display = 'block';
                    setTimeout(() => { affirmShareMsg.style.display = 'none'; }, 1500);
                });
            } else {
                // fallback: select and copy
                const temp = document.createElement('textarea');
                temp.value = text;
                document.body.appendChild(temp);
                temp.select();
                document.execCommand('copy');
                document.body.removeChild(temp);
                affirmShareMsg.style.display = 'block';
                setTimeout(() => { affirmShareMsg.style.display = 'none'; }, 1500);
            }
        };
        function showRandomAffirmation() {
            const idx = Math.floor(Math.random() * affirmations.length);
            affirmText.textContent = affirmations[idx];
        }
        window.onclick = function(event) {
            if (event.target === affirmModal) {
                affirmModal.style.display = 'none';
            }
        };
    </script>
    <!-- Journal Modal -->
    <div id="journal-modal" class="journal-modal" style="display:none;">
        <div class="journal-modal-content">
            <span class="journal-close" id="journal-close">&times;</span>
            <div class="journal-illustration">
                <i class="fas fa-pen-nib" style="font-size:2.2rem;color:#59c6cb;"></i>
            </div>
            <h3 style="color:#173D7A;margin-bottom:1rem;">My Journal</h3>
            <input type="date" id="journal-date" style="width:100%;border-radius:12px;border:1px solid #59c6cb;padding:0.5rem 1rem;margin-bottom:1rem;" />
            <textarea id="journal-entry" placeholder="Write your thoughts..." rows="4" style="width:100%;border-radius:12px;border:1px solid #59c6cb;padding:0.7rem 1rem;margin-bottom:1rem;"></textarea>
            <button class="btn primary" id="journal-save">Save Entry</button>
            <div id="journal-msg" style="color:#59c6cb;font-size:1rem;margin-top:0.5rem;display:none;">Saved!</div>
            <div id="journal-entries" class="journal-entries"></div>
        </div>
    </div>
    <script>
        // Journal Modal Logic
        const journalCard = document.getElementById('journal-card');
        const journalModal = document.getElementById('journal-modal');
        const journalClose = document.getElementById('journal-close');
        const journalEntry = document.getElementById('journal-entry');
        const journalSave = document.getElementById('journal-save');
        const journalMsg = document.getElementById('journal-msg');
        const journalEntriesDiv = document.getElementById('journal-entries');
        const journalDate = document.getElementById('journal-date');
        function loadJournalEntries() {
            const entries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
            journalEntriesDiv.innerHTML = entries.length ? '<h4 style="color:#173D7A;margin:1.2rem 0 0.5rem 0;">Previous Entries</h4>' : '';
            entries.slice().reverse().forEach((entry, idx) => {
                const div = document.createElement('div');
                div.className = 'journal-entry-item';
                div.innerHTML = `<div style='font-size:1rem;color:#173D7A;margin-bottom:0.2rem;'>${entry.text}</div><div style='font-size:0.85rem;color:#888;'>${formatDate(entry.date)}</div><button class='btn secondary journal-delete' data-idx='${entries.length-1-idx}' style='margin-top:0.3rem;'>Delete</button>`;
                journalEntriesDiv.appendChild(div);
            });
            document.querySelectorAll('.journal-delete').forEach(btn => {
                btn.onclick = function() {
                    const idx = parseInt(this.getAttribute('data-idx'));
                    entries.splice(idx, 1);
                    localStorage.setItem('journalEntries', JSON.stringify(entries));
                    loadJournalEntries();
                };
            });
        }
        journalCard.onclick = () => {
            journalModal.style.display = 'flex';
            journalEntry.value = '';
            journalDate.valueAsDate = new Date();
            loadJournalEntries();
        };
        journalClose.onclick = () => {
            journalModal.style.display = 'none';
        };
        journalSave.onclick = () => {
            const text = journalEntry.value.trim();
            const date = journalDate.value;
            if (!text || !date) return;
            const entries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
            entries.push({ text, date });
            localStorage.setItem('journalEntries', JSON.stringify(entries));
            journalEntry.value = '';
            journalMsg.style.display = 'block';
            setTimeout(() => { journalMsg.style.display = 'none'; }, 1200);
            loadJournalEntries();
        };
        function formatDate(dateStr) {
            const d = new Date(dateStr);
            return d.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });
        }
        window.onclick = function(event) {
            if (event.target === journalModal) {
                journalModal.style.display = 'none';
            }
        };
    </script>
    <!-- Mood Tracking Modal -->
    <div id="moodtrack-modal" class="moodtrack-modal" style="display:none;">
        <div class="moodtrack-modal-content">
            <span class="moodtrack-close" id="moodtrack-close">&times;</span>
            <div class="moodtrack-illustration">
                <i class="fas fa-smile" style="font-size:2.2rem;color:#59c6cb;"></i>
            </div>
            <h3 style="color:#173D7A;margin-bottom:1rem;">Mood Tracking</h3>
            <div id="moodtrack-select" class="moodtrack-select">
                <button class="moodtrack-btn" data-mood="Great" title="Great">üòä</button>
                <button class="moodtrack-btn" data-mood="Good" title="Good">üôÇ</button>
                <button class="moodtrack-btn" data-mood="Okay" title="Okay">üòê</button>
                <button class="moodtrack-btn" data-mood="Stressed" title="Stressed">üòü</button>
                <button class="moodtrack-btn" data-mood="Anxious" title="Anxious">üò∞</button>
            </div>
            <div id="moodtrack-msg" style="color:#59c6cb;font-size:1rem;margin-top:0.5rem;display:none;">Mood saved!</div>
            <div id="moodtrack-history" class="moodtrack-history"></div>
        </div>
    </div>
    <script>
        // Mood Tracking Modal Logic
        const moodtrackCard = document.getElementById('moodtrack-card');
        const moodtrackModal = document.getElementById('moodtrack-modal');
        const moodtrackClose = document.getElementById('moodtrack-close');
        const moodtrackMsg = document.getElementById('moodtrack-msg');
        const moodtrackHistory = document.getElementById('moodtrack-history');
        function loadMoodHistory() {
            const moods = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            if (!moods.length) {
                moodtrackHistory.innerHTML = '<div style="color:#888;margin-top:1.2rem;">No mood history yet.</div>';
                return;
            }
            let html = '<h4 style="color:#173D7A;margin:1.2rem 0 0.5rem 0;">Mood History</h4>';
            html += '<div class="moodtrack-entries">';
            moods.slice(-14).reverse().forEach((entry, idx) => {
                html += `
                    <div class="moodtrack-entry">
                        <div class="moodtrack-entry-content">
                            <span class="moodtrack-emoji">${entry.emoji}</span>
                            <span class="moodtrack-mood">${entry.mood}</span>
                            <span class="moodtrack-date">${formatDate(entry.date)}</span>
                        </div>
                        <button class="moodtrack-delete" data-idx="${moods.length-1-idx}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>`;
            });
            html += '</div>';
            moodtrackHistory.innerHTML = html;

            // Add delete functionality
            document.querySelectorAll('.moodtrack-delete').forEach(btn => {
                btn.onclick = function() {
                    const idx = parseInt(this.getAttribute('data-idx'));
                    const moods = JSON.parse(localStorage.getItem('moodHistory') || '[]');
                    moods.splice(idx, 1);
                    localStorage.setItem('moodHistory', JSON.stringify(moods));
                    loadMoodHistory();
                };
            });
        }
        function formatDate(dateStr) {
            const d = new Date(dateStr);
            return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
        }
        moodtrackCard.onclick = () => {
            moodtrackModal.style.display = 'flex';
            loadMoodHistory();
        };
        moodtrackClose.onclick = () => {
            moodtrackModal.style.display = 'none';
        };
        document.querySelectorAll('.moodtrack-btn').forEach(btn => {
            btn.onclick = function() {
                const mood = this.getAttribute('data-mood');
                const emoji = this.textContent;
                const moods = JSON.parse(localStorage.getItem('moodHistory') || '[]');
                moods.push({ mood, emoji, date: new Date() });
                localStorage.setItem('moodHistory', JSON.stringify(moods));
                moodtrackMsg.style.display = 'block';
                setTimeout(() => { moodtrackMsg.style.display = 'none'; }, 1200);
                loadMoodHistory();
            };
        });
        window.onclick = function(event) {
            if (event.target === moodtrackModal) {
                moodtrackModal.style.display = 'none';
            }
        };
    </script>
    <!-- Mood Logging & History -->
    <script>
        const moodBtns = document.querySelectorAll('.mood-btn');
        const moodConfirmation = document.getElementById('mood-confirmation');
        const moodHistoryBtn = document.querySelector('.mood-history-btn');
        const moodHistoryModal = document.getElementById('mood-history-modal');
        const moodHistoryClose = document.querySelector('.mood-history-close');
        const moodHistoryList = document.getElementById('mood-history-list');

        moodBtns.forEach(btn => {
            btn.onclick = function() {
                const mood = btn.getAttribute('data-mood');
                const emoji = btn.getAttribute('data-emoji');
                const moods = JSON.parse(localStorage.getItem('moodHistory') || '[]');
                moods.push({ mood, emoji, date: new Date() });
                localStorage.setItem('moodHistory', JSON.stringify(moods));
                moodConfirmation.style.display = 'block';
                setTimeout(() => { moodConfirmation.style.display = 'none'; }, 1200);
            };
            btn.onmouseover = function() { btn.style.transform = 'scale(1.08)'; };
            btn.onmouseout = function() { btn.style.transform = 'scale(1)'; };
        });

        moodHistoryBtn.onclick = function() {
            moodHistoryModal.style.display = 'flex';
            loadMoodHistory();
        };
        moodHistoryClose.onclick = function() {
            moodHistoryModal.style.display = 'none';
        };
        window.onclick = function(event) {
            if (event.target === moodHistoryModal) {
                moodHistoryModal.style.display = 'none';
            }
        };
        function loadMoodHistory() {
            const moods = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            if (!moods.length) {
                moodHistoryList.innerHTML = '<div style="color:#888;margin-top:1.2rem;">No mood history yet.</div>';
                return;
            }
            let html = '<ul style="list-style:none;padding:0;">';
            moods.slice(-14).reverse().forEach(entry => {
                html += `<li style='margin-bottom:0.7rem;display:flex;align-items:center;gap:0.7rem;'><span style='font-size:1.5rem;'>${entry.emoji}</span><span>${entry.mood}</span><span style='color:#888;font-size:0.95rem;'>${formatDate(entry.date)}</span></li>`;
            });
            html += '</ul>';
            moodHistoryList.innerHTML = html;
        }
        function formatDate(dateStr) {
            const d = new Date(dateStr);
            return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
        }
    </script>
    <!-- Enhanced Emergency Resources Modal -->
    <div id="emergency-modal" class="emergency-modal" style="display:none;">
        <div class="emergency-modal-content">
            <span class="emergency-close" id="emergency-close">&times;</span>
            <div class="emergency-tabs">
                <button class="emergency-tab active" data-tab="calm-down">Calm Down</button>
                <button class="emergency-tab" data-tab="crisis-help">Crisis Help</button>
                <button class="emergency-tab" data-tab="campus-services">Campus Services</button>
                <button class="emergency-tab" data-tab="safe-space">Safe Space</button>
            </div>

            <!-- Calm Down Section -->
            <div id="calm-down" class="emergency-tab-content active">
            <h3>Take a Deep Breath</h3>
                <div class="emergency-breathing">
                    <div class="emergency-breath-circle"></div>
                    <div class="emergency-breath-text">Breathe In</div>
            </div>
                <div class="emergency-tips">
                <h4>Quick Calming Tips</h4>
                <ul>
                    <li>Take slow, deep breaths</li>
                    <li>Focus on your senses (what you see, hear, feel)</li>
                    <li>Remind yourself: This feeling will pass</li>
                    <li>Drink a glass of water</li>
                        <li>Find a quiet space if possible</li>
                        <li>Use the 5-4-3-2-1 technique:
                            <ul>
                                <li>5 things you can see</li>
                                <li>4 things you can touch</li>
                                <li>3 things you can hear</li>
                                <li>2 things you can smell</li>
                                <li>1 thing you can taste</li>
                            </ul>
                        </li>
                </ul>
            </div>
                <div class="emergency-grounding">
                    <h4>Grounding Exercise</h4>
                    <div class="grounding-steps">
                        <button class="grounding-btn" data-step="1">Step 1: Breathe</button>
                        <button class="grounding-btn" data-step="2">Step 2: Observe</button>
                        <button class="grounding-btn" data-step="3">Step 3: Connect</button>
        </div>
                    <div id="grounding-content" class="grounding-content"></div>
    </div>
            </div>

            <!-- Crisis Help Section -->
            <div id="crisis-help" class="emergency-tab-content">
                <h3>Immediate Crisis Support</h3>
                <div class="crisis-directory">
                    <div class="crisis-card emergency">
                        <h4><i class="fas fa-phone-alt"></i> Emergency Services</h4>
                        <p class="number">911</p>
                        <p class="description">For immediate life-threatening emergencies</p>
                    </div>
                    <div class="crisis-card">
                        <h4><i class="fas fa-phone-alt"></i> National Crisis Hotline</h4>
                        <p class="number">988</p>
                        <p class="description">24/7 Suicide & Crisis Lifeline</p>
                        <button class="btn secondary call-btn" data-number="988">Call Now</button>
                    </div>
                    <div class="crisis-card">
                        <h4><i class="fas fa-phone-alt"></i> Crisis Text Line</h4>
                        <p class="number">Text HOME to 741741</p>
                        <p class="description">24/7 Crisis Counseling via Text</p>
                        <button class="btn secondary text-btn" data-number="741741">Text Now</button>
                    </div>
                    <div class="crisis-card">
                        <h4><i class="fas fa-phone-alt"></i> SAMHSA Helpline</h4>
                        <p class="number">1-800-662-HELP (4357)</p>
                        <p class="description">Treatment Referral & Information</p>
                        <button class="btn secondary call-btn" data-number="18006624357">Call Now</button>
                    </div>
                </div>
            </div>

            <!-- Campus Services Section -->
            <div id="campus-services" class="emergency-tab-content">
                <h3>Campus Mental Health Services</h3>
                <div class="campus-directory">
                    <div class="campus-card">
                        <h4><i class="fas fa-hospital"></i> Campus Health Center</h4>
                        <p class="location">Student Health Center, Building A</p>
                        <p class="hours">Mon-Fri: 8am-6pm</p>
                        <p class="number">(555) 123-4567</p>
                        <button class="btn secondary call-btn" data-number="5551234567">Call Now</button>
                    </div>
                    <div class="campus-card">
                        <h4><i class="fas fa-user-md"></i> Counseling Services</h4>
                        <p class="location">Student Services Building, Room 203</p>
                        <p class="hours">Mon-Fri: 9am-5pm</p>
                        <p class="number">(555) 123-4568</p>
                        <button class="btn secondary call-btn" data-number="5551234568">Call Now</button>
                    </div>
                    <div class="campus-card">
                        <h4><i class="fas fa-users"></i> Peer Support Group</h4>
                        <p class="location">Student Union, Room 105</p>
                        <p class="hours">Wed: 6pm-8pm</p>
                        <p class="number">(555) 123-4569</p>
                        <button class="btn secondary call-btn" data-number="5551234569">Call Now</button>
                    </div>
                    <div class="campus-card">
                        <h4><i class="fas fa-heart"></i> Wellness Center</h4>
                        <p class="location">Recreation Center, Room 301</p>
                        <p class="hours">Mon-Fri: 10am-8pm</p>
                        <p class="number">(555) 123-4570</p>
                        <button class="btn secondary call-btn" data-number="5551234570">Call Now</button>
                    </div>
                </div>
            </div>

            <!-- Safe Space Section -->
            <div id="safe-space" class="emergency-tab-content">
                <h3>Safe Space</h3>
                <div class="safe-space-content">
                    <div class="calming-visual">
                        <div class="visual-container">
                            <div class="floating-shapes"></div>
                        </div>
                        <button class="btn secondary" id="change-visual">Change Scene</button>
                    </div>
                    <div class="calming-audio">
                        <h4>Calming Sounds</h4>
                        <div class="audio-options">
                            <button class="audio-btn" data-sound="rain">üåßÔ∏è Rain</button>
                            <button class="audio-btn" data-sound="waves">üåä Ocean</button>
                            <button class="audio-btn" data-sound="forest">üå≤ Forest</button>
                            <button class="audio-btn" data-sound="whitenoise">‚ö™ White Noise</button>
                        </div>
                        <div class="audio-controls">
                            <input type="range" id="volume-control" min="0" max="100" value="50">
                            <span id="volume-label">Volume: 50%</span>
                        </div>
                    </div>
                    <div class="calming-quotes">
                        <h4>Calming Thoughts</h4>
                        <div id="quote-display" class="quote-display">
                            "This moment will pass. You are stronger than you think."
                        </div>
                        <button class="btn secondary" id="new-quote">New Quote</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Emergency Resources Modal Styles */
        .emergency-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.3);
            justify-content: center;
            align-items: center;
            z-index: 1100;
        }
        .emergency-modal-content {
            background: #fff;
            border-radius: 18px;
            padding: 2rem;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 6px 24px rgba(89,198,203,0.18);
        }
        .emergency-close {
            position: absolute;
            right: 1.2rem;
            top: 1.2rem;
            font-size: 1.5rem;
            color: #888;
            cursor: pointer;
        }
        .emergency-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 0.5rem;
            flex-wrap: wrap;
        }
        .emergency-tab {
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            color: #666;
            cursor: pointer;
            font-weight: 500;
            transition: color 0.3s;
        }
        .emergency-tab.active {
            color: #59c6cb;
            border-bottom: 2px solid #59c6cb;
            margin-bottom: -0.5rem;
        }
        .emergency-tab-content {
            display: none;
        }
        .emergency-tab-content.active {
            display: block;
        }

        /* Calm Down Section Styles */
        .emergency-breathing {
            margin: 1.5rem 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .emergency-breath-circle {
            width: 100px;
            height: 100px;
            background: #59c6cb;
            border-radius: 50%;
            margin-bottom: 1rem;
            transition: transform 1.2s cubic-bezier(.4,2,.6,1);
        }
        .emergency-breath-text {
            font-size: 1.2rem;
            color: #173D7A;
            font-weight: 500;
        }
        .emergency-tips {
            margin: 1.5rem 0;
            text-align: left;
        }
        .emergency-tips h4 {
            color: #173D7A;
            margin-bottom: 0.8rem;
        }
        .emergency-tips ul {
            color: #7a8fa6;
            margin: 0;
            padding-left: 1.2rem;
        }
        .emergency-tips ul ul {
            margin-top: 0.5rem;
        }
        .grounding-steps {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }
        .grounding-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #59c6cb;
            border-radius: 8px;
            background: none;
            color: #59c6cb;
            cursor: pointer;
            transition: all 0.3s;
        }
        .grounding-btn:hover {
            background: #59c6cb;
            color: #fff;
        }
        .grounding-content {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            min-height: 100px;
        }

        /* Crisis Help Section Styles */
        .crisis-directory {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .crisis-card {
            padding: 1.2rem;
            background: #f8f9fa;
            border-radius: 12px;
            text-align: center;
        }
        .crisis-card.emergency {
            background: #ffebee;
            border: 2px solid #c62828;
        }
        .crisis-card h4 {
            color: #173D7A;
            margin-bottom: 0.5rem;
        }
        .crisis-card .number {
            font-size: 1.2rem;
            font-weight: 600;
            color: #59c6cb;
            margin: 0.5rem 0;
        }
        .crisis-card .description {
            color: #7a8fa6;
            margin-bottom: 1rem;
        }
        .call-btn, .text-btn {
            width: 100%;
            margin-top: 0.5rem;
        }

        /* Campus Services Section Styles */
        .campus-directory {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .campus-card {
            padding: 1.2rem;
            background: #f8f9fa;
            border-radius: 12px;
        }
        .campus-card h4 {
            color: #173D7A;
            margin-bottom: 0.8rem;
        }
        .campus-card p {
            margin: 0.3rem 0;
            color: #7a8fa6;
        }
        .campus-card .number {
            color: #59c6cb;
            font-weight: 500;
        }

        /* Safe Space Section Styles */
        .safe-space-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }
        .calming-visual {
            grid-column: 1 / -1;
            text-align: center;
        }
        .visual-container {
            width: 100%;
            height: 200px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }
        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        .floating-shapes::before,
        .floating-shapes::after {
            content: '';
            position: absolute;
            width: 50px;
            height: 50px;
            background: #59c6cb;
            border-radius: 50%;
            animation: float 8s infinite;
        }
        .floating-shapes::after {
            background: #173D7A;
            animation-delay: -4s;
        }
        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(100px, 50px); }
            50% { transform: translate(50px, 100px); }
            75% { transform: translate(-50px, 50px); }
        }
        .audio-options {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin: 1rem 0;
        }
        .audio-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #59c6cb;
            border-radius: 8px;
            background: none;
            color: #59c6cb;
            cursor: pointer;
            transition: all 0.3s;
        }
        .audio-btn:hover {
            background: #59c6cb;
            color: #fff;
        }
        .audio-btn.playing {
            background: #59c6cb;
            color: #fff;
        }
        .audio-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        .quote-display {
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 12px;
            margin: 1rem 0;
            font-style: italic;
            color: #173D7A;
        }

        @media (max-width: 768px) {
            .emergency-modal-content {
                padding: 1.2rem;
            }
            .emergency-tabs {
                flex-direction: column;
                gap: 0.5rem;
            }
            .emergency-tab {
                width: 100%;
                text-align: center;
            }
            .crisis-directory,
            .campus-directory {
                grid-template-columns: 1fr;
            }
            .safe-space-content {
                grid-template-columns: 1fr;
            }
        }
        .academic-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.3);
            justify-content: center;
            align-items: center;
            z-index: 1200; /* Ensure above emergency modal */
        }
        .breath-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 2rem 0;
            position: relative;
        }
        .breath-rings {
            position: relative;
            width: 260px;
            height: 260px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .breath-circle {
            width: 150px;
            height: 150px;
            background: #59c6cb;
            border-radius: 50%;
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            margin: auto;
            box-shadow: 0 4px 24px rgba(89,198,203,0.15);
            z-index: 2;
            transition: transform 1.2s cubic-bezier(.4,2,.6,1);
        }
        .breath-ring {
            position: absolute;
            left: 50%;
            top: 50%;
            border-radius: 50%;
            border: 7px solid #59c6cb;
            opacity: 0.25;
            transform: translate(-50%, -50%) scale(1);
            z-index: 1;
            pointer-events: none;
            transition: transform 1.2s cubic-bezier(.4,2,.6,1), opacity 1.2s;
        }
        .ring1 { width: 200px; height: 200px; border-color: #59c6cb; }
        .ring2 { width: 230px; height: 230px; border-color: #173D7A; opacity: 0.18; }
        .ring3 { width: 260px; height: 260px; border-color: #59c6cb; opacity: 0.12; }
        .breath-text {
            margin-top: 1.2rem;
            font-size: 1.4rem;
            color: #173D7A;
            font-weight: 500;
            text-align: center;
        }
    </style>

    <script>
        // Emergency Resources Modal Logic
        const panicBtn = document.querySelector('.panic-btn');
        const emergencyModal = document.getElementById('emergency-modal');
        const emergencyClose = document.getElementById('emergency-close');
        const emergencyTabs = document.querySelectorAll('.emergency-tab');
        const emergencyContents = document.querySelectorAll('.emergency-tab-content');
        const emergencyBreathText = document.querySelector('.emergency-breath-text');
        const emergencyBreathCircle = document.querySelector('.emergency-breath-circle');
        let emergencyBreathPhase = 0;
        let emergencyBreathInterval;

        panicBtn.onclick = () => {
            emergencyModal.style.display = 'flex';
            startEmergencyBreathing();
        };
        emergencyClose.onclick = () => {
            emergencyModal.style.display = 'none';
            stopEmergencyBreathing();
            stopAllAudio();
        };
        emergencyTabs.forEach(tab => {
            tab.onclick = () => {
                emergencyTabs.forEach(t => t.classList.remove('active'));
                emergencyContents.forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            };
        });

        // Emergency Breathing Animation
        function startEmergencyBreathing() {
            if (emergencyBreathInterval) clearInterval(emergencyBreathInterval);
            emergencyBreathPhase = 0;
            animateEmergencyBreath();
        }

        function stopEmergencyBreathing() {
            if (emergencyBreathInterval) clearInterval(emergencyBreathInterval);
        }

        function animateEmergencyBreath() {
            if (!emergencyModal || emergencyModal.style.display === 'none') return;
            emergencyBreathText.textContent = breathPhases[emergencyBreathPhase].text;
            emergencyBreathCircle.style.transform =
                breathPhases[emergencyBreathPhase].text === 'Breathe In' ? 'scale(1.2)' :
                breathPhases[emergencyBreathPhase].text === 'Breathe Out' ? 'scale(0.8)' : 'scale(1)';
            emergencyBreathInterval = setTimeout(() => {
                emergencyBreathPhase = (emergencyBreathPhase + 1) % breathPhases.length;
                animateEmergencyBreath();
            }, breathPhases[emergencyBreathPhase].duration);
        }

        // Grounding Exercise
        const groundingBtns = document.querySelectorAll('.grounding-btn');
        const groundingContent = document.getElementById('grounding-content');
        const groundingSteps = {
            1: "Take 3 deep breaths. Feel your chest rise and fall. Notice the air moving in and out of your body.",
            2: "Look around you. Name 5 things you can see. Notice their colors, shapes, and textures.",
            3: "Connect with your body. Feel your feet on the ground. Notice the weight of your body. Wiggle your fingers and toes."
        };

        groundingBtns.forEach(btn => {
            btn.onclick = () => {
                const step = btn.dataset.step;
                groundingContent.textContent = groundingSteps[step];
                groundingBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            };
        });

        // Crisis Directory
        const callBtns = document.querySelectorAll('.call-btn');
        const textBtns = document.querySelectorAll('.text-btn');

        callBtns.forEach(btn => {
            btn.onclick = () => {
                const number = btn.dataset.number;
                window.location.href = `tel:${number}`;
            };
        });

        textBtns.forEach(btn => {
            btn.onclick = () => {
                const number = btn.dataset.number;
                window.location.href = `sms:${number}`;
            };
        });

        // Safe Space
        const audioBtns = document.querySelectorAll('.audio-btn');
        const volumeControl = document.getElementById('volume-control');
        const volumeLabel = document.getElementById('volume-label');
        const newQuoteBtn = document.getElementById('new-quote');
        const changeVisualBtn = document.getElementById('change-visual');
        let currentAudio = null;

        const calmingQuotes = [
            "This moment will pass. You are stronger than you think.",
            "Take it one breath at a time. You've got this.",
            "You are safe. You are supported. You are not alone.",
            "Your feelings are valid, and they will pass.",
            "In this moment, you are exactly where you need to be.",
            "You have survived 100% of your worst days.",
            "This is temporary. You are permanent.",
            "You are doing the best you can, and that is enough."
        ];

        const audioFiles = {
            rain: 'https://assets.mixkit.co/sfx/preview/mixkit-rain-and-thunder-storm-2393.mp3',
            waves: 'https://assets.mixkit.co/sfx/preview/mixkit-ocean-waves-loop-2394.mp3',
            forest: 'https://assets.mixkit.co/sfx/preview/mixkit-forest-birds-ambience-1210.mp3',
            whitenoise: 'https://assets.mixkit.co/sfx/preview/mixkit-white-noise-ambience-loop-2395.mp3'
        };

        audioBtns.forEach(btn => {
            btn.onclick = () => {
                const sound = btn.dataset.sound;
                if (currentAudio) {
                    currentAudio.pause();
                    currentAudio = null;
                }
                if (btn.classList.contains('playing')) {
                    btn.classList.remove('playing');
                    return;
                }
                audioBtns.forEach(b => b.classList.remove('playing'));
                btn.classList.add('playing');
                currentAudio = new Audio(audioFiles[sound]);
                currentAudio.loop = true;
                currentAudio.volume = volumeControl.value / 100;
                currentAudio.play();
            };
        });

        volumeControl.oninput = () => {
            const volume = volumeControl.value;
            volumeLabel.textContent = `Volume: ${volume}%`;
            if (currentAudio) {
                currentAudio.volume = volume / 100;
            }
        };

        newQuoteBtn.onclick = () => {
            const randomQuote = calmingQuotes[Math.floor(Math.random() * calmingQuotes.length)];
            document.getElementById('quote-display').textContent = randomQuote;
        };

        function stopAllAudio() {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio = null;
            }
            audioBtns.forEach(btn => btn.classList.remove('playing'));
        }

        // Visual Scenes
        const visualScenes = [
            { color1: '#59c6cb', color2: '#173D7A' },
            { color1: '#ffb6c1', color2: '#ff69b4' },
            { color1: '#98fb98', color2: '#228b22' },
            { color1: '#dda0dd', color2: '#9932cc' }
        ];
        let currentScene = 0;

        changeVisualBtn.onclick = () => {
            currentScene = (currentScene + 1) % visualScenes.length;
            const scene = visualScenes[currentScene];
            const shapes = document.querySelector('.floating-shapes');
            shapes.style.setProperty('--color1', scene.color1);
            shapes.style.setProperty('--color2', scene.color2);
        };

        // Initialize
        window.onclick = (event) => {
            if (event.target === emergencyModal) {
                emergencyModal.style.display = 'none';
                stopEmergencyBreathing();
                stopAllAudio();
            }
        };
    </script>
    <script>
        // Personalize greeting if user name is available
        const greeting = document.getElementById('greeting');
        const storedName = localStorage.getItem('studentName');
        if (storedName && greeting) {
            greeting.textContent = `Hi there, ${storedName}!`;
        }
        // Animate mood buttons on load
        const moodBtnsArr = Array.from(document.querySelectorAll('.mood-btn'));
        moodBtnsArr.forEach((btn, i) => {
            btn.style.opacity = 0;
            btn.style.transform = 'translateY(30px)';
            setTimeout(() => {
                btn.style.transition = 'opacity 0.5s, transform 0.5s';
                btn.style.opacity = 1;
                btn.style.transform = 'translateY(0)';
            }, 200 + i * 120);
        });
        // Pulse animation for Panic Button
        const panicBtn = document.querySelector('.panic-btn');
        panicBtn.classList.add('pulse-anim');
        // Highlight mood button on click
        moodBtnsArr.forEach(btn => {
            btn.addEventListener('click', function() {
                btn.classList.add('mood-selected');
                setTimeout(() => btn.classList.remove('mood-selected'), 700);
            });
        });
        // Accessibility: ESC to close modals, focus trap
        function trapFocus(modal) {
            const focusableEls = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            const firstEl = focusableEls[0];
            const lastEl = focusableEls[focusableEls.length - 1];
            modal.addEventListener('keydown', function(e) {
                if (e.key === 'Tab') {
                    if (e.shiftKey) {
                        if (document.activeElement === firstEl) {
                            e.preventDefault();
                            lastEl.focus();
                        }
                    } else {
                        if (document.activeElement === lastEl) {
                            e.preventDefault();
                            firstEl.focus();
                        }
                    }
                }
                if (e.key === 'Escape') {
                    modal.style.display = 'none';
                }
            });
        }
        if (moodHistoryModal) trapFocus(moodHistoryModal);
        if (emergencyModal) trapFocus(emergencyModal);
    </script>
    <script>
        // Academic Support Modal Logic (robust, only one modal at a time)
        (function() {
            const academicCard = document.getElementById('academic-card');
            const academicModal = document.getElementById('academic-modal');
            const academicClose = document.getElementById('academic-close');
            const emergencyModal = document.getElementById('emergency-modal');
            if (academicCard && academicModal && academicClose) {
                academicCard.onclick = () => {
                    // Close emergency modal if open
                    if (emergencyModal && emergencyModal.style.display === 'flex') {
                        emergencyModal.style.display = 'none';
                    }
                    academicModal.style.display = 'flex';
                };
                academicClose.onclick = () => {
                    academicModal.style.display = 'none';
                };
                window.addEventListener('click', function(event) {
                    if (event.target === academicModal) {
                        academicModal.style.display = 'none';
                    }
                });
            }
        })();
    </script>
    <!-- Academic Support Modal -->
    <div id="academic-modal" class="academic-modal" style="display:none;">
        <div class="academic-modal-content">
            <span class="academic-close" id="academic-close">&times;</span>
            <div class="academic-tabs">
                <button class="academic-tab active" data-tab="gpa-calculator">GPA Calculator</button>
                <button class="academic-tab" data-tab="course-planner">Course Planner</button>
                <button class="academic-tab" data-tab="deadline-tracker">Deadline Tracker</button>
                <button class="academic-tab" data-tab="study-schedule">Study Schedule</button>
            </div>
            <!-- GPA Calculator -->
            <div id="gpa-calculator" class="academic-tab-content active">
                <h3>GPA Calculator</h3>
                <div class="gpa-form">
                    <div class="course-entry">
                        <input type="text" placeholder="Course Name" class="course-name">
                        <select class="course-grade">
                            <option value="4.0">A (4.0)</option>
                            <option value="3.7">A- (3.7)</option>
                            <option value="3.3">B+ (3.3)</option>
                            <option value="3.0">B (3.0)</option>
                            <option value="2.7">B- (2.7)</option>
                            <option value="2.3">C+ (2.3)</option>
                            <option value="2.0">C (2.0)</option>
                            <option value="1.7">C- (1.7)</option>
                            <option value="1.3">D+ (1.3)</option>
                            <option value="1.0">D (1.0)</option>
                            <option value="0.0">F (0.0)</option>
                        </select>
                        <input type="number" placeholder="Credits" class="course-credits" min="1" max="6" value="3">
                        <button class="remove-course" style="display:none;">√ó</button>
                    </div>
                    <button class="btn secondary" id="add-course">Add Course</button>
                    <button class="btn primary" id="calculate-gpa">Calculate GPA</button>
                    <div id="gpa-result" class="gpa-result"></div>
                </div>
            </div>
            <!-- Course Load Planner -->
            <div id="course-planner" class="academic-tab-content">
                <h3>Course Load Planner</h3>
                <div class="course-planner-form">
                    <div class="semester-entry">
                        <h4>Current Semester</h4>
                        <div class="course-list">
                            <div class="course-item">
                                <input type="text" placeholder="Course Name" class="planned-course">
                                <input type="number" placeholder="Credits" class="planned-credits" min="1" max="6" value="3">
                                <select class="course-difficulty">
                                    <option value="easy">Easy</option>
                                    <option value="medium">Medium</option>
                                    <option value="hard">Hard</option>
                                </select>
                                <button class="remove-planned-course" style="display:none;">√ó</button>
                            </div>
                        </div>
                        <button class="btn secondary" id="add-planned-course">Add Course</button>
                        <button class="btn primary" id="analyze-load">Analyze Load</button>
                        <div id="load-analysis" class="load-analysis"></div>
                    </div>
                </div>
            </div>
            <!-- Deadline Tracker -->
            <div id="deadline-tracker" class="academic-tab-content">
                <h3>Deadline Tracker</h3>
                <div class="deadline-form">
                    <input type="text" placeholder="Assignment Name" id="assignment-name">
                    <input type="date" id="assignment-date">
                    <select id="assignment-priority">
                        <option value="high">High Priority</option>
                        <option value="medium">Medium Priority</option>
                        <option value="low">Low Priority</option>
                    </select>
                    <button class="btn primary" id="add-deadline">Add Deadline</button>
                    <div id="deadlines-list" class="deadlines-list"></div>
                </div>
            </div>
            <!-- Study Schedule Generator -->
            <div id="study-schedule" class="academic-tab-content">
                <h3>Study Schedule Generator</h3>
                <div class="schedule-form">
                    <div class="schedule-inputs">
                        <div class="time-block">
                            <label>Study Start Time</label>
                            <input type="time" id="study-start">
                        </div>
                        <div class="time-block">
                            <label>Study End Time</label>
                            <input type="time" id="study-end">
                        </div>
                        <div class="break-block">
                            <label>Break Duration (minutes)</label>
                            <input type="number" id="break-duration" min="5" max="30" value="15">
                        </div>
                        <div class="subjects-block">
                            <label>Subjects to Study</label>
                            <div id="subjects-list">
                                <div class="subject-item">
                                    <input type="text" placeholder="Subject" class="subject-name">
                                    <input type="number" placeholder="Hours" class="subject-hours" min="0.5" max="4" step="0.5" value="1">
                                    <button class="remove-subject" style="display:none;">√ó</button>
                                </div>
                            </div>
                            <button class="btn secondary" id="add-subject">Add Subject</button>
                        </div>
                    </div>
                    <button class="btn primary" id="generate-schedule">Generate Schedule</button>
                    <div id="schedule-result" class="schedule-result"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Academic Support Modal Functionality
        (function() {
            // Tab switching
            const academicTabs = document.querySelectorAll('.academic-tab');
            const academicContents = document.querySelectorAll('.academic-tab-content');
            academicTabs.forEach(tab => {
                tab.onclick = () => {
                    academicTabs.forEach(t => t.classList.remove('active'));
                    academicContents.forEach(c => c.classList.remove('active'));
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.tab).classList.add('active');
                };
            });

            // GPA Calculator
            const addCourseBtn = document.getElementById('add-course');
            const calculateGpaBtn = document.getElementById('calculate-gpa');
            const gpaResult = document.getElementById('gpa-result');
            const courseEntries = document.querySelector('.gpa-form');
            addCourseBtn.onclick = () => {
                const newEntry = document.querySelector('.course-entry').cloneNode(true);
                newEntry.querySelector('.remove-course').style.display = 'block';
                newEntry.querySelectorAll('input').forEach(input => input.value = '');
                newEntry.querySelector('select').selectedIndex = 0;
                newEntry.querySelector('.remove-course').onclick = function() {
                    newEntry.remove();
                };
                courseEntries.insertBefore(newEntry, addCourseBtn);
            };
            document.querySelectorAll('.remove-course').forEach(btn => {
                btn.onclick = function() {
                    btn.parentElement.remove();
                };
            });
            calculateGpaBtn.onclick = () => {
                const entries = document.querySelectorAll('.course-entry');
                let totalPoints = 0;
                let totalCredits = 0;
                entries.forEach(entry => {
                    const grade = parseFloat(entry.querySelector('.course-grade').value);
                    const credits = parseInt(entry.querySelector('.course-credits').value);
                    if (!isNaN(grade) && !isNaN(credits)) {
                        totalPoints += grade * credits;
                        totalCredits += credits;
                    }
                });
                const gpa = totalCredits > 0 ? (totalPoints / totalCredits).toFixed(2) : 0;
                gpaResult.innerHTML = `<h4>Your GPA: ${gpa}</h4><p>Total Credits: ${totalCredits}</p>`;
            };

            // Course Load Planner
            const addPlannedCourseBtn = document.getElementById('add-planned-course');
            const analyzeLoadBtn = document.getElementById('analyze-load');
            const loadAnalysis = document.getElementById('load-analysis');
            const courseList = document.querySelector('.course-list');
            addPlannedCourseBtn.onclick = () => {
                const newCourse = document.querySelector('.course-item').cloneNode(true);
                newCourse.querySelector('.remove-planned-course').style.display = 'block';
                newCourse.querySelectorAll('input').forEach(input => input.value = '');
                newCourse.querySelector('select').selectedIndex = 0;
                newCourse.querySelector('.remove-planned-course').onclick = function() {
                    newCourse.remove();
                };
                courseList.appendChild(newCourse);
            };
            document.querySelectorAll('.remove-planned-course').forEach(btn => {
                btn.onclick = function() {
                    btn.parentElement.remove();
                };
            });
            analyzeLoadBtn.onclick = () => {
                const courses = document.querySelectorAll('.course-item');
                let totalCredits = 0;
                let difficultyScore = 0;
                courses.forEach(course => {
                    const credits = parseInt(course.querySelector('.planned-credits').value) || 0;
                    const difficulty = course.querySelector('.course-difficulty').value;
                    totalCredits += credits;
                    switch(difficulty) {
                        case 'easy': difficultyScore += credits; break;
                        case 'medium': difficultyScore += credits * 1.5; break;
                        case 'hard': difficultyScore += credits * 2; break;
                    }
                });
                const averageDifficulty = totalCredits > 0 ? (difficultyScore / totalCredits) : 0;
                let loadAssessment = '';
                if (averageDifficulty < 1.3) loadAssessment = 'Light';
                else if (averageDifficulty < 1.7) loadAssessment = 'Moderate';
                else loadAssessment = 'Heavy';
                loadAnalysis.innerHTML = `<h4>Course Load Analysis</h4><p>Total Credits: ${totalCredits}</p><p>Difficulty Level: ${loadAssessment}</p><p>Average Course Difficulty: ${averageDifficulty.toFixed(1)}</p>`;
            };

            // Deadline Tracker
            const addDeadlineBtn = document.getElementById('add-deadline');
            const deadlinesList = document.getElementById('deadlines-list');
            let deadlines = JSON.parse(localStorage.getItem('deadlines') || '[]');
            function saveDeadlines() {
                localStorage.setItem('deadlines', JSON.stringify(deadlines));
            }
            function renderDeadlines() {
                deadlinesList.innerHTML = deadlines.map((deadline, index) => `
                    <div class="deadline-item">
                        <div>
                            <strong>${deadline.name}</strong>
                            <span class="deadline-priority priority-${deadline.priority}">${deadline.priority}</span>
                        </div>
                        <div>
                            <span>${new Date(deadline.date).toLocaleDateString()}</span>
                            <button class="btn secondary" onclick="deleteDeadline(${index})">Delete</button>
                        </div>
                    </div>
                `).join('');
            }
            addDeadlineBtn.onclick = () => {
                const name = document.getElementById('assignment-name').value;
                const date = document.getElementById('assignment-date').value;
                const priority = document.getElementById('assignment-priority').value;
                if (name && date) {
                    deadlines.push({ name, date, priority });
                    saveDeadlines();
                    renderDeadlines();
                    document.getElementById('assignment-name').value = '';
                    document.getElementById('assignment-date').value = '';
                }
            };
            window.deleteDeadline = (index) => {
                deadlines.splice(index, 1);
                saveDeadlines();
                renderDeadlines();
            };
            renderDeadlines();

            // Study Schedule Generator
            const addSubjectBtn = document.getElementById('add-subject');
            const generateScheduleBtn = document.getElementById('generate-schedule');
            const scheduleResult = document.getElementById('schedule-result');
            const subjectsList = document.getElementById('subjects-list');
            addSubjectBtn.onclick = () => {
                const newSubject = document.querySelector('.subject-item').cloneNode(true);
                newSubject.querySelector('.remove-subject').style.display = 'block';
                newSubject.querySelectorAll('input').forEach(input => input.value = '');
                newSubject.querySelector('.remove-subject').onclick = function() {
                    newSubject.remove();
                };
                subjectsList.appendChild(newSubject);
            };
            document.querySelectorAll('.remove-subject').forEach(btn => {
                btn.onclick = function() {
                    btn.parentElement.remove();
                };
            });
            generateScheduleBtn.onclick = () => {
                const startTime = document.getElementById('study-start').value;
                const endTime = document.getElementById('study-end').value;
                const breakDuration = parseInt(document.getElementById('break-duration').value) || 15;
                if (!startTime || !endTime) {
                    scheduleResult.innerHTML = '<p style="color: #c62828;">Please set start and end times</p>';
                    return;
                }
                const subjects = Array.from(document.querySelectorAll('.subject-item')).map(item => ({
                    name: item.querySelector('.subject-name').value,
                    hours: parseFloat(item.querySelector('.subject-hours').value) || 0
                })).filter(subject => subject.name && subject.hours > 0);
                if (subjects.length === 0) {
                    scheduleResult.innerHTML = '<p style="color: #c62828;">Please add at least one subject</p>';
                    return;
                }
                const start = new Date(`2000-01-01T${startTime}`);
                const end = new Date(`2000-01-01T${endTime}`);
                const totalMinutes = (end - start) / (1000 * 60);
                const totalStudyHours = subjects.reduce((sum, subject) => sum + subject.hours, 0);
                if (totalStudyHours > totalMinutes / 60) {
                    scheduleResult.innerHTML = '<p style="color: #c62828;">Total study hours exceed available time</p>';
                    return;
                }
                let schedule = [];
                let currentTime = new Date(start);
                subjects.forEach(subject => {
                    const subjectMinutes = subject.hours * 60;
                    const endTime = new Date(currentTime.getTime() + subjectMinutes * 60000);
                    schedule.push({
                        subject: subject.name,
                        start: new Date(currentTime),
                        end: endTime
                    });
                    currentTime = new Date(endTime.getTime() + breakDuration * 60000);
                });
                scheduleResult.innerHTML = `
                    <h4>Your Study Schedule</h4>
                    ${schedule.map(slot => `
                        <div class="schedule-slot">
                            <strong>${slot.subject}</strong>
                            <p>${slot.start.toLocaleTimeString()} - ${slot.end.toLocaleTimeString()}</p>
                        </div>
                    `).join('')}
                `;
            };
        })();
    </script>
    <!-- Profile Modal -->
    <div id="profile-modal" class="profile-modal" style="display:none;">
      <div class="profile-modal-content">
        <span class="profile-modal-close" id="profile-modal-close">&times;</span>
        <div class="profile-avatar-section">
          <img id="profile-avatar" class="profile-avatar" src="https://randomuser.me/api/portraits/men/32.jpg" alt="User Avatar">
          <input type="file" id="avatar-upload" accept="image/*" style="display:none;">
          <button class="btn secondary" id="change-avatar-btn">Change Avatar</button>
        </div>
        <div class="profile-fields">
          <label for="profile-name">Name</label>
          <input type="text" id="profile-name" class="profile-input" maxlength="32">
          <label for="profile-bio">Bio</label>
          <textarea id="profile-bio" class="profile-input" rows="3" maxlength="120" placeholder="Tell us about yourself..."></textarea>
        </div>
        <button class="btn primary" id="save-profile-btn">Save Changes</button>
      </div>
    </div>
    <style>
    .profile-modal {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.25);
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
    .profile-modal-content {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 24px rgba(89,198,203,0.15);
      padding: 2.5rem 2rem 2rem 2rem;
      max-width: 400px;
      width: 95vw;
      text-align: center;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .profile-modal-close {
      position: absolute;
      top: 1.2rem;
      right: 1.5rem;
      font-size: 2rem;
      color: #59c6cb;
      cursor: pointer;
      font-weight: 700;
      transition: color 0.2s;
    }
    .profile-modal-close:hover {
      color: #FF5A5F;
    }
    .profile-avatar-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .profile-avatar {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #59c6cb;
      margin-bottom: 0.7rem;
    }
    .profile-fields {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      margin-bottom: 1.2rem;
    }
    .profile-input {
      width: 100%;
      padding: 0.7rem 1rem;
      border-radius: 10px;
      border: 1.5px solid #59c6cb;
      font-size: 1rem;
      margin-bottom: 0.2rem;
    }
    </style>
    <script>
    // Profile Modal Logic
    (function() {
      const profileBtn = document.querySelector('.profile-top-btn');
      const profileModal = document.getElementById('profile-modal');
      const profileClose = document.getElementById('profile-modal-close');
      const profileAvatar = document.getElementById('profile-avatar');
      const changeAvatarBtn = document.getElementById('change-avatar-btn');
      const avatarUpload = document.getElementById('avatar-upload');
      const profileName = document.getElementById('profile-name');
      const profileBio = document.getElementById('profile-bio');
      const saveProfileBtn = document.getElementById('save-profile-btn');
      const profileTopName = document.querySelector('.profile-top-name');
      const profileTopAvatar = document.querySelector('.profile-top-avatar');

      // Load profile from localStorage
      function loadProfile() {
        const data = JSON.parse(localStorage.getItem('profileData') || '{}');
        if (data.avatar) profileAvatar.src = data.avatar;
        if (data.name) profileName.value = data.name;
        if (data.bio) profileBio.value = data.bio;
        if (profileTopName && data.name) profileTopName.textContent = data.name;
        if (profileTopAvatar && data.avatar) profileTopAvatar.src = data.avatar;
      }

      // Save profile to localStorage
      function saveProfile() {
        const data = {
          avatar: profileAvatar.src,
          name: profileName.value.trim() || 'Student',
          bio: profileBio.value.trim()
        };
        localStorage.setItem('profileData', JSON.stringify(data));
        if (profileTopName) profileTopName.textContent = data.name;
        if (profileTopAvatar) profileTopAvatar.src = data.avatar;
      }

      // Open modal
      if (profileBtn && profileModal) {
        profileBtn.onclick = () => {
          loadProfile();
          profileModal.style.display = 'flex';
        };
      }
      // Close modal
      if (profileClose && profileModal) {
        profileClose.onclick = () => {
          profileModal.style.display = 'none';
        };
        window.addEventListener('cliyesck', function(event) {
          if (event.target === profileModal) {
            profileModal.style.display = 'none';
          }
        });
      }
      // Change avatar
      if (changeAvatarBtn && avatarUpload) {
        changeAvatarBtn.onclick = () => avatarUpload.click();
        avatarUpload.onchange = function() {
          const file = this.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
              profileAvatar.src = e.target.result;
            };
            reader.readAsDataURL(file);
          }
        };
      }
      // Save changes
      if (saveProfileBtn) {
        saveProfileBtn.onclick = () => {
          saveProfile();
          profileModal.style.display = 'none';
        };
      }
      // On page load, update header if profile exists
      loadProfile();
    })();
    </script>
    <script>
    // Profile Badge Logic for Header
    (function() {
        const profileTopName = document.querySelector('.profile-top-name');
        const profileTopAvatar = document.querySelector('.profile-top-avatar');
        function updateHeaderBadge() {
            const data = JSON.parse(localStorage.getItem('profilePageData') || '{}');
            if (data.avatar) profileTopAvatar.src = data.avatar;
            else profileTopAvatar.src = 'https://randomuser.me/api/portraits/men/32.jpg';
            profileTopName.textContent = data.name && data.name.trim() ? data.name : 'Profile';
        }
        updateHeaderBadge();
        window.addEventListener('storage', updateHeaderBadge);
    })();
    </script>
</body>
</html> 